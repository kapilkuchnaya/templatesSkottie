{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers'\nimport { SignJWT, jwtVerify } from 'jose'\n\nconst secretKey = process.env.SESSION_SECRET;\nconst key = new TextEncoder().encode(secretKey);\n\nexport async function encrypt(payload: any) {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('1d')\n    .sign(key)\n}\n\nexport async function decrypt(input: string): Promise<any> {\n  try {\n    const { payload } = await jwtVerify(input, key, {\n      algorithms: ['HS256'],\n    })\n    return payload\n  } catch (error) {\n    return null\n  }\n}\n\nexport async function createSession(userId: string) {\n  const expires = new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 hours\n  const session = await encrypt({ userId, expires })\n\n  cookies().set('session', session, { expires, httpOnly: true })\n}\n\nexport async function getSession() {\n  const sessionCookie = cookies().get('session')?.value\n  if (!sessionCookie) return null\n\n  const session = await decrypt(sessionCookie);\n  if (!session) return null;\n\n  if (new Date(session.expires) < new Date()) {\n    return null;\n  }\n  \n  return session;\n}\n\nexport async function deleteSession() {\n  cookies().set('session', '', { expires: new Date(0) })\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,cAAc;AAC5C,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,QAAQ,OAAY;IACxC,OAAO,MAAM,IAAI,0JAAA,CAAA,UAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAQ,KAAa;IACzC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,4JAAA,CAAA,YAAS,AAAD,EAAE,OAAO,KAAK;YAC9C,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,cAAc,MAAc;IAChD,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK,MAAM,WAAW;;IACtE,MAAM,UAAU,MAAM,QAAQ;QAAE;QAAQ;IAAQ;IAEhD,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,WAAW,SAAS;QAAE;QAAS,UAAU;IAAK;AAC9D;AAEO,eAAe;IACpB,MAAM,gBAAgB,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,YAAY;IAChD,IAAI,CAAC,eAAe,OAAO;IAE3B,MAAM,UAAU,MAAM,QAAQ;IAC9B,IAAI,CAAC,SAAS,OAAO;IAErB,IAAI,IAAI,KAAK,QAAQ,OAAO,IAAI,IAAI,QAAQ;QAC1C,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,WAAW,IAAI;QAAE,SAAS,IAAI,KAAK;IAAG;AACtD","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/actions.ts"],"sourcesContent":["\n\"use server\";\n\nimport { redirect } from \"next/navigation\";\nimport { revalidatePath } from \"next/cache\";\nimport { createSession, deleteSession } from \"@/lib/auth\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\nimport type { Template } from \"./definitions\";\n\nexport type State = {\n  error?: string;\n  message?: string;\n};\n\n// Generic function to read templates from a specified file\nasync function readTemplatesFromFile(fileName: string): Promise<{ [category: string]: Template[] }> {\n    const filePath = path.join(process.cwd(), 'src', 'lib', 'data', fileName);\n    try {\n      const currentData = await fs.readFile(filePath, 'utf-8');\n      const templates = JSON.parse(currentData);\n      return typeof templates === 'object' && templates !== null && !Array.isArray(templates) ? templates : {};\n    } catch (e) {\n      if ((e as NodeJS.ErrnoException).code === 'ENOENT') {\n        // If file doesn't exist, create it with an empty object\n        await writeTemplatesToFile(fileName, {});\n        return {};\n      }\n      // For other errors (like parsing), return empty\n      return {};\n    }\n  }\n  \n  // Generic function to write templates to a specified file\n  async function writeTemplatesToFile(fileName: string, templates: { [category: string]: Template[] }): Promise<void> {\n    const filePath = path.join(process.cwd(), 'src', 'lib', 'data', fileName);\n    const dir = path.dirname(filePath);\n    await fs.mkdir(dir, { recursive: true });\n    await fs.writeFile(filePath, JSON.stringify(templates, null, 2), 'utf-8');\n  }\n\n// --- Default DB Actions ---\nconst DEFAULT_DB_FILE = 'templates.json';\n\nexport async function uploadTemplate(prevState: State | undefined, formData: FormData) {\n    return await uploadTemplateBase(DEFAULT_DB_FILE, prevState, formData);\n}\n\nexport async function toggleTemplateProStatus(originalId: string, currentStatus: boolean) {\n    return await toggleTemplateProStatusBase(DEFAULT_DB_FILE, originalId, currentStatus, \"/admin\");\n}\n\nexport async function toggleTemplateMultiStatus(originalId: string, currentStatus: boolean) {\n    return await toggleTemplateMultiStatusBase(DEFAULT_DB_FILE, originalId, currentStatus, \"/admin\");\n}\n\nexport async function deleteTemplate(originalId: string) {\n    return await deleteTemplateBase(DEFAULT_DB_FILE, originalId, \"/admin\");\n}\n\n\n// --- Second DB Actions ---\nconst SECOND_DB_FILE = 'template2-db.json';\n\nexport async function uploadTemplateDb(prevState: State | undefined, formData: FormData) {\n    return await uploadTemplateBase(SECOND_DB_FILE, prevState, formData);\n}\n\nexport async function toggleTemplateProStatusDb(originalId: string, currentStatus: boolean) {\n    return await toggleTemplateProStatusBase(SECOND_DB_FILE, originalId, currentStatus, \"/admin/templates-db\");\n}\n\nexport async function toggleTemplateMultiStatusDb(originalId: string, currentStatus: boolean) {\n    return await toggleTemplateMultiStatusBase(SECOND_DB_FILE, originalId, currentStatus, \"/admin/templates-db\");\n}\n\nexport async function deleteTemplateDb(originalId: string) {\n    return await deleteTemplateBase(SECOND_DB_FILE, originalId, \"/admin/templates-db\");\n}\n\n\n// --- Base Action Logic ---\n\nasync function uploadTemplateBase(dbFile: string, prevState: State | undefined, formData: FormData) {\n  const file = formData.get(\"templateFile\") as File | null;\n  let jsonContent = formData.get(\"templateJson\") as string | null;\n  let newTemplateContent: string | undefined;\n\n  if (file && file.size > 0) {\n    if (file.type !== \"application/json\") {\n      return { error: \"Invalid file type. Please upload a JSON file.\" };\n    }\n    newTemplateContent = await file.text();\n  } else if (jsonContent) {\n    newTemplateContent = jsonContent;\n  } else {\n    return { error: \"Please select a file or paste JSON content to upload.\" };\n  }\n\n  if (!newTemplateContent) {\n    return { error: \"No template content found.\" };\n  }\n\n  try {\n    let sanitizedContent = newTemplateContent.trim();\n    if (!sanitizedContent.startsWith('[') && sanitizedContent.endsWith('}')) {\n        sanitizedContent = `[${sanitizedContent}]`;\n    }\n    \n    const parsedData = JSON.parse(sanitizedContent);\n    const templatesToProcess = Array.isArray(parsedData) ? parsedData : [parsedData];\n    \n    const templates = await readTemplatesFromFile(dbFile);\n    let templatesAddedCount = 0;\n\n    for (const newTemplate of templatesToProcess) {\n      if (!newTemplate.category || !Array.isArray(newTemplate.category) || newTemplate.category.length === 0) {\n        if(templatesToProcess.length > 1) continue; \n        return { error: \"Each template must have a 'category' array with at least one category.\" };\n      }\n      \n      const primaryCategory = newTemplate.category[0];\n      const uniqueId = Math.random().toString(36).substring(2, 15);\n\n      const templateWithId: Template = {\n        ...newTemplate,\n        id: newTemplate.id || uniqueId,\n        templateId: newTemplate.templateId || uniqueId,\n      };\n      \n      if (!templates[primaryCategory]) {\n        templates[primaryCategory] = [];\n      }\n\n      templates[primaryCategory].unshift(templateWithId);\n      templatesAddedCount++;\n    }\n    \n    await writeTemplatesToFile(dbFile, templates);\n\n    const revalidationPath = dbFile === SECOND_DB_FILE ? \"/admin/templates-db\" : \"/admin\";\n    revalidatePath(revalidationPath);\n    return { message: `${templatesAddedCount} template(s) uploaded successfully!` };\n\n  } catch (error) {\n    console.error(error);\n    if (error instanceof SyntaxError) {\n      return { error: \"Invalid JSON format in the uploaded file or text.\" };\n    }\n    return { error: \"An unexpected error occurred while uploading the template.\" };\n  }\n}\n\nasync function toggleTemplateProStatusBase(dbFile: string, originalId: string, currentStatus: boolean, revalidationPath: string) {\n    try {\n      const templatesByCat = await readTemplatesFromFile(dbFile);\n      let found = false;\n  \n      for (const category in templatesByCat) {\n        const templateIndex = templatesByCat[category].findIndex(t => (t.id === originalId || t.templateId === originalId));\n        if (templateIndex !== -1) {\n          templatesByCat[category][templateIndex].pro = !currentStatus;\n          found = true;\n          break;\n        }\n      }\n  \n      if (!found) {\n        return { error: \"Template not found.\" };\n      }\n      \n      await writeTemplatesToFile(dbFile, templatesByCat);\n  \n      revalidatePath(revalidationPath);\n      return { message: `Template status changed successfully.` };\n    } catch (error) {\n      console.error(error);\n      return { error: \"Failed to update template status.\" };\n    }\n}\n\nasync function toggleTemplateMultiStatusBase(dbFile: string, originalId: string, currentStatus: boolean, revalidationPath: string) {\n    try {\n      const templatesByCat = await readTemplatesFromFile(dbFile);\n      let found = false;\n  \n      for (const category in templatesByCat) {\n        const templateIndex = templatesByCat[category].findIndex(t => (t.id === originalId || t.templateId === originalId));\n        if (templateIndex !== -1) {\n          templatesByCat[category][templateIndex].isMultipleTemplate = !currentStatus;\n          found = true;\n          break;\n        }\n      }\n  \n      if (!found) {\n        return { error: \"Template not found.\" };\n      }\n      \n      await writeTemplatesToFile(dbFile, templatesByCat);\n  \n      revalidatePath(revalidationPath);\n      return { message: `Template multiple status changed successfully.` };\n    } catch (error) {\n      console.error(error);\n      return { error: \"Failed to update template multiple status.\" };\n    }\n}\n\nasync function deleteTemplateBase(dbFile: string, originalId: string, revalidationPath: string) {\n    try {\n      const templatesByCat = await readTemplatesFromFile(dbFile);\n      let foundAndDeleted = false;\n  \n      for (const category in templatesByCat) {\n        const initialLength = templatesByCat[category].length;\n        templatesByCat[category] = templatesByCat[category].filter(t => (t.id !== originalId && t.templateId !== originalId));\n        if (templatesByCat[category].length < initialLength) {\n          foundAndDeleted = true;\n          if (templatesByCat[category].length === 0) {\n              delete templatesByCat[category];\n          }\n          break; \n        }\n      }\n  \n      if (!foundAndDeleted) {\n        return { error: \"Template not found to delete.\" };\n      }\n  \n      await writeTemplatesToFile(dbFile, templatesByCat);\n  \n      revalidatePath(revalidationPath);\n      return { message: \"Template deleted successfully.\" };\n    } catch (error) {\n      console.error(error);\n      return { error: \"Failed to delete template.\" };\n    }\n}\n\n// --- Auth Actions ---\nexport async function authenticate(\n  prevState: State | undefined,\n  formData: FormData\n) {\n  try {\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n    \n    if (email !== process.env.ADMIN_EMAIL) {\n      return { error: \"Invalid email address.\" };\n    }\n\n    if (password !== process.env.ADMIN_PASSWORD) {\n      return { error: \"Invalid password.\" };\n    }\n\n    await createSession(email);\n\n  } catch (error) {\n    if ((error as Error).message.includes(\"CredentialsSignin\")) {\n      return { error: \"Invalid credentials.\" };\n    }\n    return { error: \"Something went wrong.\" };\n  }\n  redirect(\"/admin\");\n}\n\n\nexport async function logout() {\n  await deleteSession();\n  redirect(\"/\");\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/admin/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logout as '009fb872ef6e593b70b3a3e1d2dd02a82287c7f66b'} from 'ACTIONS_MODULE0'\nexport {deleteTemplateDb as '400c23683a4388243db1212c4219d6919d16a47721'} from 'ACTIONS_MODULE0'\nexport {deleteTemplate as '40a242b78bf3c308840471631b905412891b158634'} from 'ACTIONS_MODULE0'\nexport {uploadTemplateDb as '603adedf048c24623454e943645362eddde2f135ee'} from 'ACTIONS_MODULE0'\nexport {toggleTemplateMultiStatus as '6059cd153796468d4bad3be1f043ef279fceec49c0'} from 'ACTIONS_MODULE0'\nexport {toggleTemplateProStatus as '605ebdba1a157410461afe12ff28c7292394bb03d6'} from 'ACTIONS_MODULE0'\nexport {toggleTemplateMultiStatusDb as '6074138201d2fd2df7a178250d8044fa432a8ffa5d'} from 'ACTIONS_MODULE0'\nexport {authenticate as '60922b336b8354a99e49216e2c19945e6c44dbe7c1'} from 'ACTIONS_MODULE0'\nexport {toggleTemplateProStatusDb as '6097edc0931a576ff840ad641a0eb2933653aa7d38'} from 'ACTIONS_MODULE0'\nexport {uploadTemplate as '60cbb3701b3d531f83a4757a0a2a05ce853bb511fe'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 495, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/data.ts"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport type { Template } from './definitions';\n\nasync function getTemplatesFromFile(fileName: string): Promise<Template[]> {\n    const filePath = path.join(process.cwd(), 'src', 'lib', 'data', fileName);\n    try {\n        const jsonData = await fs.promises.readFile(filePath, 'utf-8');\n        if (!jsonData) {\n        return [];\n        }\n        const data: { [category: string]: Template[] } = JSON.parse(jsonData);\n\n        if (typeof data !== 'object' || data === null || Array.isArray(data)) {\n            console.error(`Error: ${fileName} is not a category-grouped object.`);\n            return [];\n        }\n\n        const allTemplates = Object.values(data).flat();\n        return allTemplates;\n\n    } catch (error) {\n        if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\n            console.log(`${fileName} not found. Returning empty array.`);\n            // Create the file if it doesn't exist.\n            const dir = path.dirname(filePath);\n            await fs.promises.mkdir(dir, { recursive: true });\n            await fs.promises.writeFile(filePath, '{}', 'utf-8');\n            return [];\n        }\n        console.error(`Error reading or parsing ${fileName}:`, error);\n        return [];\n    }\n}\n\n\nexport async function getTemplates(): Promise<Template[]> {\n  return getTemplatesFromFile('templates.json');\n}\n\nexport async function getTemplatesDb(): Promise<Template[]> {\n  return getTemplatesFromFile('template2-db.json');\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGA,eAAe,qBAAqB,QAAgB;IAChD,MAAM,WAAW,iGAAA,CAAA,UAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,OAAO,OAAO,QAAQ;IAChE,IAAI;QACA,MAAM,WAAW,MAAM,6FAAA,CAAA,UAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,UAAU;QACtD,IAAI,CAAC,UAAU;YACf,OAAO,EAAE;QACT;QACA,MAAM,OAA2C,KAAK,KAAK,CAAC;QAE5D,IAAI,OAAO,SAAS,YAAY,SAAS,QAAQ,MAAM,OAAO,CAAC,OAAO;YAClE,QAAQ,KAAK,CAAC,CAAC,OAAO,EAAE,SAAS,kCAAkC,CAAC;YACpE,OAAO,EAAE;QACb;QAEA,MAAM,eAAe,OAAO,MAAM,CAAC,MAAM,IAAI;QAC7C,OAAO;IAEX,EAAE,OAAO,OAAO;QACZ,IAAI,AAAC,MAAgC,IAAI,KAAK,UAAU;YACpD,QAAQ,GAAG,CAAC,GAAG,SAAS,kCAAkC,CAAC;YAC3D,uCAAuC;YACvC,MAAM,MAAM,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC;YACzB,MAAM,6FAAA,CAAA,UAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK;gBAAE,WAAW;YAAK;YAC/C,MAAM,6FAAA,CAAA,UAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAU,MAAM;YAC5C,OAAO,EAAE;QACb;QACA,QAAQ,KAAK,CAAC,CAAC,yBAAyB,EAAE,SAAS,CAAC,CAAC,EAAE;QACvD,OAAO,EAAE;IACb;AACJ;AAGO,eAAe;IACpB,OAAO,qBAAqB;AAC9B;AAEO,eAAe;IACpB,OAAO,qBAAqB;AAC9B","debugId":null}},
    {"offset": {"line": 544, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 560, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 620, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/auth/auth-button.tsx"],"sourcesContent":["import { logout } from \"@/lib/actions\";\nimport { Button } from \"@/components/ui/button\";\nimport { LogOut } from \"lucide-react\";\n\nexport function AuthButton() {\n  return (\n    <form action={logout}>\n      <Button variant=\"ghost\" size=\"icon\" aria-label=\"Sign Out\">\n        <LogOut className=\"h-5 w-5\" />\n      </Button>\n    </form>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEO,SAAS;IACd,qBACE,8OAAC;QAAK,QAAQ,qHAAA,CAAA,SAAM;kBAClB,cAAA,8OAAC,kIAAA,CAAA,SAAM;YAAC,SAAQ;YAAQ,MAAK;YAAO,cAAW;sBAC7C,cAAA,8OAAC,0MAAA,CAAA,SAAM;gBAAC,WAAU;;;;;;;;;;;;;;;;AAI1B","debugId":null}},
    {"offset": {"line": 662, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/icons.tsx"],"sourcesContent":["import type { SVGProps } from \"react\";\n\nexport function IconSkottie(props: SVGProps<SVGSVGElement>) {\n    return (\n        <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            {...props}\n        >\n            <path d=\"M12 2l-8 4 8 4 8-4-8-4z\" />\n            <path d=\"M4 10l8 4 8-4\" />\n            <path d=\"M4 18l8-4 8 4\" />\n            <path d=\"M4 14l8 4 8-4\" />\n        </svg>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEO,SAAS,YAAY,KAA8B;IACtD,qBACI,8OAAC;QACG,OAAM;QACN,SAAQ;QACR,MAAK;QACL,QAAO;QACP,aAAY;QACZ,eAAc;QACd,gBAAe;QACd,GAAG,KAAK;;0BAET,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;;;;;;;AAGpB","debugId":null}},
    {"offset": {"line": 719, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/header.tsx"],"sourcesContent":["import Link from \"next/link\";\nimport { AuthButton } from \"@/components/auth/auth-button\";\nimport { IconSkottie } from \"@/components/icons\";\n\nexport function Header() {\n  return (\n    <header className=\"sticky top-0 z-30 flex h-16 items-center gap-4 border-b bg-background px-4 md:px-6\">\n      <nav className=\"flex w-full items-center gap-6 text-lg font-medium md:text-sm\">\n        <Link\n          href=\"/admin\"\n          className=\"flex items-center gap-2 text-lg font-semibold md:text-base\"\n        >\n          <IconSkottie className=\"h-7 w-7 text-primary\" />\n          <span className=\"font-headline text-xl\">Skottie Viewer</span>\n        </Link>\n\n        <Link href=\"/admin/templates-db\" className=\"text-muted-foreground transition-colors hover:text-foreground\">\n            Templates DB\n        </Link>\n\n        <div className=\"ml-auto flex items-center gap-2\">\n          <AuthButton />\n        </div>\n      </nav>\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEO,SAAS;IACd,qBACE,8OAAC;QAAO,WAAU;kBAChB,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC,4JAAA,CAAA,UAAI;oBACH,MAAK;oBACL,WAAU;;sCAEV,8OAAC,2HAAA,CAAA,cAAW;4BAAC,WAAU;;;;;;sCACvB,8OAAC;4BAAK,WAAU;sCAAwB;;;;;;;;;;;;8BAG1C,8OAAC,4JAAA,CAAA,UAAI;oBAAC,MAAK;oBAAsB,WAAU;8BAAgE;;;;;;8BAI3G,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,4IAAA,CAAA,aAAU;;;;;;;;;;;;;;;;;;;;;AAKrB","debugId":null}},
    {"offset": {"line": 800, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/template-grid.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const TemplateGrid = registerClientReference(\n    function() { throw new Error(\"Attempted to call TemplateGrid() from the server but TemplateGrid is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/templates/template-grid.tsx <module evaluation>\",\n    \"TemplateGrid\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,4EACA","debugId":null}},
    {"offset": {"line": 814, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/template-grid.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const TemplateGrid = registerClientReference(\n    function() { throw new Error(\"Attempted to call TemplateGrid() from the server but TemplateGrid is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/templates/template-grid.tsx\",\n    \"TemplateGrid\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,wDACA","debugId":null}},
    {"offset": {"line": 828, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 838, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/upload-template-button.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const UploadTemplateButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call UploadTemplateButton() from the server but UploadTemplateButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/templates/upload-template-button.tsx <module evaluation>\",\n    \"UploadTemplateButton\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,qFACA","debugId":null}},
    {"offset": {"line": 852, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/upload-template-button.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const UploadTemplateButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call UploadTemplateButton() from the server but UploadTemplateButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/templates/upload-template-button.tsx\",\n    \"UploadTemplateButton\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,iEACA","debugId":null}},
    {"offset": {"line": 866, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 876, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/template-grid-page.tsx"],"sourcesContent":["import type { Template } from \"@/lib/definitions\";\nimport { Header } from \"@/components/header\";\nimport { TemplateGrid } from \"@/components/templates/template-grid\";\nimport { UploadTemplateButton } from \"./upload-template-button\";\n\ninterface TemplateGridPageProps {\n    title: string;\n    templates: Template[];\n    categories: string[];\n    formats: string[];\n    db: 'default' | 'db2';\n}\n\nexport function TemplateGridPage({ title, templates, categories, formats, db }: TemplateGridPageProps) {\n  return (\n    <div className=\"flex min-h-screen w-full flex-col\">\n      <Header />\n      <main className=\"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8\">\n        <div className=\"flex items-center justify-between\">\n            <h1 className=\"font-headline text-3xl font-bold\">{title}</h1>\n            <UploadTemplateButton db={db} />\n        </div>\n        <TemplateGrid templates={templates} categories={categories} formats={formats} db={db} />\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;;;;;AAUO,SAAS,iBAAiB,EAAE,KAAK,EAAE,SAAS,EAAE,UAAU,EAAE,OAAO,EAAE,EAAE,EAAyB;IACnG,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,4HAAA,CAAA,SAAM;;;;;0BACP,8OAAC;gBAAK,WAAU;;kCACd,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAG,WAAU;0CAAoC;;;;;;0CAClD,8OAAC,+JAAA,CAAA,uBAAoB;gCAAC,IAAI;;;;;;;;;;;;kCAE9B,8OAAC,mJAAA,CAAA,eAAY;wBAAC,WAAW;wBAAW,YAAY;wBAAY,SAAS;wBAAS,IAAI;;;;;;;;;;;;;;;;;;AAI1F","debugId":null}},
    {"offset": {"line": 952, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/page.tsx"],"sourcesContent":["import { getTemplates } from \"@/lib/data\";\nimport { TemplateGridPage } from \"@/components/templates/template-grid-page\";\n\nexport default async function AdminPage() {\n  const templates = await getTemplates();\n\n  const allCategories = [\n    ...new Set(templates.flatMap((template) => template.category)),\n  ];\n\n  const allFormats = [\n    ...new Set(templates.map((template) => template.type || \"Uncategorized\")),\n  ];\n\n  return (\n    <TemplateGridPage \n        title=\"Skottie Viewer\"\n        templates={templates} \n        categories={allCategories} \n        formats={allFormats}\n        db=\"default\"\n    />\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEe,eAAe;IAC5B,MAAM,YAAY,MAAM,CAAA,GAAA,kHAAA,CAAA,eAAY,AAAD;IAEnC,MAAM,gBAAgB;WACjB,IAAI,IAAI,UAAU,OAAO,CAAC,CAAC,WAAa,SAAS,QAAQ;KAC7D;IAED,MAAM,aAAa;WACd,IAAI,IAAI,UAAU,GAAG,CAAC,CAAC,WAAa,SAAS,IAAI,IAAI;KACzD;IAED,qBACE,8OAAC,2JAAA,CAAA,mBAAgB;QACb,OAAM;QACN,WAAW;QACX,YAAY;QACZ,SAAS;QACT,IAAG;;;;;;AAGX","debugId":null}}]
}