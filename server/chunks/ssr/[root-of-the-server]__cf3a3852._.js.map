{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers'\nimport { SignJWT, jwtVerify } from 'jose'\n\nconst secretKey = process.env.SESSION_SECRET;\nconst key = new TextEncoder().encode(secretKey);\n\nexport async function encrypt(payload: any) {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('1d')\n    .sign(key)\n}\n\nexport async function decrypt(input: string): Promise<any> {\n  try {\n    const { payload } = await jwtVerify(input, key, {\n      algorithms: ['HS256'],\n    })\n    return payload\n  } catch (error) {\n    return null\n  }\n}\n\nexport async function createSession(userId: string) {\n  const expires = new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 hours\n  const session = await encrypt({ userId, expires })\n\n  cookies().set('session', session, { expires, httpOnly: true })\n}\n\nexport async function getSession() {\n  const sessionCookie = cookies().get('session')?.value\n  if (!sessionCookie) return null\n\n  const session = await decrypt(sessionCookie);\n  if (!session) return null;\n\n  if (new Date(session.expires) < new Date()) {\n    return null;\n  }\n  \n  return session;\n}\n\nexport async function deleteSession() {\n  cookies().set('session', '', { expires: new Date(0) })\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,cAAc;AAC5C,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,QAAQ,OAAY;IACxC,OAAO,MAAM,IAAI,0JAAA,CAAA,UAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAQ,KAAa;IACzC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,4JAAA,CAAA,YAAS,AAAD,EAAE,OAAO,KAAK;YAC9C,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,cAAc,MAAc;IAChD,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK,MAAM,WAAW;;IACtE,MAAM,UAAU,MAAM,QAAQ;QAAE;QAAQ;IAAQ;IAEhD,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,WAAW,SAAS;QAAE;QAAS,UAAU;IAAK;AAC9D;AAEO,eAAe;IACpB,MAAM,gBAAgB,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,YAAY;IAChD,IAAI,CAAC,eAAe,OAAO;IAE3B,MAAM,UAAU,MAAM,QAAQ;IAC9B,IAAI,CAAC,SAAS,OAAO;IAErB,IAAI,IAAI,KAAK,QAAQ,OAAO,IAAI,IAAI,QAAQ;QAC1C,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,WAAW,IAAI;QAAE,SAAS,IAAI,KAAK;IAAG;AACtD","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/actions.ts"],"sourcesContent":["\n\"use server\";\n\nimport { redirect } from \"next/navigation\";\nimport { revalidatePath } from \"next/cache\";\nimport { createSession, deleteSession } from \"@/lib/auth\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\nimport type { Template } from \"./definitions\";\n\nexport type State = {\n  error?: string;\n  message?: string;\n};\n\nexport async function authenticate(\n  prevState: State | undefined,\n  formData: FormData\n) {\n  try {\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n    \n    if (email !== process.env.ADMIN_EMAIL) {\n      return { error: \"Invalid email address.\" };\n    }\n\n    if (password !== process.env.ADMIN_PASSWORD) {\n      return { error: \"Invalid password.\" };\n    }\n\n    await createSession(email);\n\n  } catch (error) {\n    if ((error as Error).message.includes(\"CredentialsSignin\")) {\n      return { error: \"Invalid credentials.\" };\n    }\n    return { error: \"Something went wrong.\" };\n  }\n  redirect(\"/admin\");\n}\n\n\nexport async function logout() {\n  await deleteSession();\n  redirect(\"/\");\n}\n\nasync function getFilePath(db: 'main' | 'db' | 'db-new'): Promise<string> {\n    const fileMap = {\n        'main': 'templates.json',\n        'db': 'template2-db.json',\n        'db-new': 'template2-db-new.json'\n    };\n    const fileName = fileMap[db] || 'templates.json';\n    return path.join(process.cwd(), 'src', 'lib', 'data', fileName);\n}\n\nasync function readTemplatesFromFile(db: 'main' | 'db' | 'db-new'): Promise<{ [category: string]: Template[] }> {\n  const filePath = await getFilePath(db);\n  try {\n    const currentData = await fs.readFile(filePath, 'utf-8');\n    if (!currentData.trim()) return {};\n    const templates = JSON.parse(currentData);\n    return typeof templates === 'object' && templates !== null && !Array.isArray(templates) ? templates : {};\n  } catch (e) {\n    return {};\n  }\n}\n\nasync function writeTemplatesToFile(db: 'main' | 'db' | 'db-new', templates: { [category: string]: Template[] } | string): Promise<void> {\n  const filePath = await getFilePath(db);\n  const content = typeof templates === 'string' ? templates : JSON.stringify(templates, null, 2);\n  await fs.writeFile(filePath, content, 'utf-8');\n}\n\n\nasync function handleTemplateUpload(formData: FormData, db: 'main' | 'db' | 'db-new') {\n    const file = formData.get(\"templateFile\") as File | null;\n    let jsonContent = formData.get(\"templateJson\") as string | null;\n    let newTemplateContent: string | undefined;\n\n    if (file && file.size > 0) {\n        if (file.type !== \"application/json\") {\n            return { error: \"Invalid file type. Please upload a JSON file.\" };\n        }\n        newTemplateContent = await file.text();\n    } else if (jsonContent) {\n        newTemplateContent = jsonContent;\n    } else {\n        return { error: \"Please select a file or paste JSON content to upload.\" };\n    }\n\n    if (!newTemplateContent) {\n        return { error: \"No template content found.\" };\n    }\n\n    try {\n        let sanitizedContent = newTemplateContent.trim();\n        const parsedData = JSON.parse(sanitizedContent);\n        const templatesToProcess = Array.isArray(parsedData) ? parsedData : [parsedData];\n        \n        const templates = await readTemplatesFromFile(db);\n        let templatesAddedCount = 0;\n\n        for (const newTemplate of templatesToProcess) {\n            if (!newTemplate.category || !Array.isArray(newTemplate.category) || newTemplate.category.length === 0) {\n                if(templatesToProcess.length > 1) continue; \n                return { error: \"Each template must have a 'category' array with at least one category.\" };\n            }\n            \n            const primaryCategory = newTemplate.category[0];\n            const uniqueId = newTemplate.id || newTemplate.templateId || Math.random().toString(36).substring(2, 15);\n\n\n            const templateWithId: Template = {\n                ...newTemplate,\n                id: uniqueId,\n                templateId: uniqueId,\n            };\n            \n            if (!templates[primaryCategory]) {\n                templates[primaryCategory] = [];\n            }\n\n            templates[primaryCategory].unshift(templateWithId);\n            templatesAddedCount++;\n        }\n        \n        await writeTemplatesToFile(db, templates);\n\n        const revalidationPath = db === 'main' ? \"/admin\" : `/admin/templates-${db}`;\n        revalidatePath(revalidationPath);\n        return { message: `${templatesAddedCount} template(s) uploaded successfully!` };\n\n    } catch (error) {\n        console.error(error);\n        if (error instanceof SyntaxError) {\n            return { error: \"Invalid JSON format in the uploaded file or text.\" };\n        }\n        return { error: \"An unexpected error occurred while uploading the template.\" };\n    }\n}\n\nasync function handleToggleProStatus(originalId: string, currentStatus: boolean, db: 'main' | 'db' | 'db-new') {\n    try {\n        const templatesByCat = await readTemplatesFromFile(db);\n        let found = false;\n\n        for (const category in templatesByCat) {\n            const templateIndex = templatesByCat[category].findIndex(t => (t.id === originalId || t.templateId === originalId));\n            if (templateIndex !== -1) {\n                templatesByCat[category][templateIndex].pro = !currentStatus;\n                found = true;\n                break;\n            }\n        }\n\n        if (!found) return { error: \"Template not found.\" };\n        \n        await writeTemplatesToFile(db, templatesByCat);\n\n        const revalidationPath = db === 'main' ? \"/admin\" : `/admin/templates-${db}`;\n        revalidatePath(revalidationPath);\n        return { message: `Template status changed successfully.` };\n    } catch (error) {\n        console.error(error);\n        return { error: \"Failed to update template status.\" };\n    }\n}\n\nasync function handleToggleMultiStatus(originalId: string, currentStatus: boolean, db: 'main' | 'db' | 'db-new') {\n    try {\n        const templatesByCat = await readTemplatesFromFile(db);\n        let found = false;\n\n        for (const category in templatesByCat) {\n            const templateIndex = templatesByCat[category].findIndex(t => (t.id === originalId || t.templateId === originalId));\n            if (templateIndex !== -1) {\n                templatesByCat[category][templateIndex].isMultipleTemplate = !currentStatus;\n                found = true;\n                break;\n            }\n        }\n\n        if (!found) return { error: \"Template not found.\" };\n        \n        await writeTemplatesToFile(db, templatesByCat);\n\n        const revalidationPath = db === 'main' ? \"/admin\" : `/admin/templates-${db}`;\n        revalidatePath(revalidationPath);\n        return { message: `Template multiple status changed successfully.` };\n    } catch (error) {\n        console.error(error);\n        return { error: \"Failed to update template multiple status.\" };\n    }\n}\n\nasync function handleDeleteTemplate(originalId: string, db: 'main' | 'db' | 'db-new') {\n    try {\n        const templatesByCat = await readTemplatesFromFile(db);\n        let foundAndDeleted = false;\n\n        for (const category in templatesByCat) {\n            const initialLength = templatesByCat[category].length;\n            templatesByCat[category] = templatesByCat[category].filter(t => (t.id !== originalId && t.templateId !== originalId));\n            if (templatesByCat[category].length < initialLength) {\n                foundAndDeleted = true;\n                if (templatesByCat[category].length === 0) {\n                    delete templatesByCat[category];\n                }\n                break; \n            }\n        }\n\n        if (!foundAndDeleted) return { error: \"Template not found to delete.\" };\n\n        await writeTemplatesToFile(db, templatesByCat);\n\n        const revalidationPath = db === 'main' ? \"/admin\" : `/admin/templates-${db}`;\n        revalidatePath(revalidationPath);\n        return { message: \"Template deleted successfully.\" };\n    } catch (error) {\n        console.error(error);\n        return { error: \"Failed to delete template.\" };\n    }\n}\n\n\n// Main DB Actions\nexport async function uploadTemplate(prevState: State | undefined, formData: FormData) {\n    return handleTemplateUpload(formData, 'main');\n}\nexport async function toggleTemplateProStatus(originalId: string, currentStatus: boolean) {\n    return handleToggleProStatus(originalId, currentStatus, 'main');\n}\nexport async function toggleTemplateMultiStatus(originalId: string, currentStatus: boolean) {\n    return handleToggleMultiStatus(originalId, currentStatus, 'main');\n}\nexport async function deleteTemplate(originalId: string) {\n    return handleDeleteTemplate(originalId, 'main');\n}\n\n\n// Second DB Actions\nexport async function uploadTemplateDb(prevState: State | undefined, formData: FormData) {\n    return handleTemplateUpload(formData, 'db');\n}\nexport async function toggleTemplateProStatusDb(originalId: string, currentStatus: boolean) {\n    return handleToggleProStatus(originalId, currentStatus, 'db');\n}\nexport async function toggleTemplateMultiStatusDb(originalId: string, currentStatus: boolean) {\n    return handleToggleMultiStatus(originalId, currentStatus, 'db');\n}\nexport async function deleteTemplateDb(originalId: string) {\n    return handleDeleteTemplate(originalId, 'db');\n}\n\n// Third DB Actions (new)\nexport async function uploadTemplateDbNew(prevState: State | undefined, formData: FormData) {\n    return handleTemplateUpload(formData, 'db-new');\n}\nexport async function toggleTemplateProStatusDbNew(originalId: string, currentStatus: boolean) {\n    return handleToggleProStatus(originalId, currentStatus, 'db-new');\n}\nexport async function toggleTemplateMultiStatusDbNew(originalId: string, currentStatus: boolean) {\n    return handleToggleMultiStatus(originalId, currentStatus, 'db-new');\n}\nexport async function deleteTemplateDbNew(originalId: string) {\n    return handleDeleteTemplate(originalId, 'db-new');\n}\nexport async function saveTemplatesDbNew(jsonContent: string) {\n    try {\n        JSON.parse(jsonContent);\n        await writeTemplatesToFile('db-new', jsonContent);\n        revalidatePath('/admin/templates-db-new');\n        return { message: \"Templates saved successfully.\" };\n    } catch (error) {\n        console.error(error);\n        if (error instanceof SyntaxError) {\n            return { error: \"Invalid JSON format.\" };\n        }\n        return { error: \"Failed to save templates.\" };\n    }\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 443, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/admin/templates-db-new/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {saveTemplatesDbNew as '40bcf7d9e14908faffc1bfaf07afa9111107777633'} from 'ACTIONS_MODULE0'\nexport {uploadTemplate as '60cbb3701b3d531f83a4757a0a2a05ce853bb511fe'} from 'ACTIONS_MODULE0'\nexport {uploadTemplateDb as '603adedf048c24623454e943645362eddde2f135ee'} from 'ACTIONS_MODULE0'\nexport {uploadTemplateDbNew as '605dac353029d896248a2387509fc33466ac8b9125'} from 'ACTIONS_MODULE0'\nexport {logout as '009fb872ef6e593b70b3a3e1d2dd02a82287c7f66b'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 507, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/data.ts"],"sourcesContent":["import fs from 'fs/promises';\nimport path from 'path';\nimport type { Template } from './definitions';\n\nasync function getTemplatesFromDb(db: 'main' | 'db' | 'db-new'): Promise<Template[]> {\n  const fileMap = {\n    'main': 'templates.json',\n    'db': 'template2-db.json',\n    'db-new': 'template2-db-new.json'\n  };\n  const fileName = fileMap[db] || 'templates.json';\n  const filePath = path.join(process.cwd(), 'src', 'lib', 'data', fileName);\n  \n  try {\n    const jsonData = await fs.readFile(filePath, 'utf-8');\n    if (!jsonData || jsonData.trim() === '') return [];\n    \n    const data: { [category: string]: Template[] } = JSON.parse(jsonData);\n\n    if (typeof data !== 'object' || data === null || Array.isArray(data)) {\n        console.error(`Error: ${fileName} is not a category-grouped object.`);\n        return [];\n    }\n\n    return Object.values(data).flat();\n\n  } catch (error) {\n    if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\n      await fs.writeFile(filePath, JSON.stringify({}, null, 2), 'utf-8');\n      return [];\n    }\n    console.error(`Error reading or parsing ${fileName}:`, error);\n    return [];\n  }\n}\n\nexport async function getTemplates(): Promise<Template[]> {\n  return getTemplatesFromDb('main');\n}\n\nexport async function getTemplatesDb(): Promise<Template[]> {\n    return getTemplatesFromDb('db');\n}\n\nexport async function getTemplatesDbNew(): Promise<Template[]> {\n    return getTemplatesFromDb('db-new');\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;AAGA,eAAe,mBAAmB,EAA4B;IAC5D,MAAM,UAAU;QACd,QAAQ;QACR,MAAM;QACN,UAAU;IACZ;IACA,MAAM,WAAW,OAAO,CAAC,GAAG,IAAI;IAChC,MAAM,WAAW,iGAAA,CAAA,UAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,OAAO,OAAO,QAAQ;IAEhE,IAAI;QACF,MAAM,WAAW,MAAM,qHAAA,CAAA,UAAE,CAAC,QAAQ,CAAC,UAAU;QAC7C,IAAI,CAAC,YAAY,SAAS,IAAI,OAAO,IAAI,OAAO,EAAE;QAElD,MAAM,OAA2C,KAAK,KAAK,CAAC;QAE5D,IAAI,OAAO,SAAS,YAAY,SAAS,QAAQ,MAAM,OAAO,CAAC,OAAO;YAClE,QAAQ,KAAK,CAAC,CAAC,OAAO,EAAE,SAAS,kCAAkC,CAAC;YACpE,OAAO,EAAE;QACb;QAEA,OAAO,OAAO,MAAM,CAAC,MAAM,IAAI;IAEjC,EAAE,OAAO,OAAO;QACd,IAAI,AAAC,MAAgC,IAAI,KAAK,UAAU;YACtD,MAAM,qHAAA,CAAA,UAAE,CAAC,SAAS,CAAC,UAAU,KAAK,SAAS,CAAC,CAAC,GAAG,MAAM,IAAI;YAC1D,OAAO,EAAE;QACX;QACA,QAAQ,KAAK,CAAC,CAAC,yBAAyB,EAAE,SAAS,CAAC,CAAC,EAAE;QACvD,OAAO,EAAE;IACX;AACF;AAEO,eAAe;IACpB,OAAO,mBAAmB;AAC5B;AAEO,eAAe;IAClB,OAAO,mBAAmB;AAC9B;AAEO,eAAe;IAClB,OAAO,mBAAmB;AAC9B","debugId":null}},
    {"offset": {"line": 557, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/template-editor-layout.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const TemplateEditorLayout = registerClientReference(\n    function() { throw new Error(\"Attempted to call TemplateEditorLayout() from the server but TemplateEditorLayout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/templates/template-editor-layout.tsx <module evaluation>\",\n    \"TemplateEditorLayout\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,qFACA","debugId":null}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/templates/template-editor-layout.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const TemplateEditorLayout = registerClientReference(\n    function() { throw new Error(\"Attempted to call TemplateEditorLayout() from the server but TemplateEditorLayout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/templates/template-editor-layout.tsx\",\n    \"TemplateEditorLayout\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,iEACA","debugId":null}},
    {"offset": {"line": 585, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 595, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/templates-db-new/page.tsx"],"sourcesContent":["import { getTemplatesDbNew } from \"@/lib/data\";\nimport { TemplateEditorLayout } from \"@/components/templates/template-editor-layout\";\n\nexport default async function TemplatesDbNewPage() {\n    const templates = await getTemplatesDbNew();\n\n    return (\n        <TemplateEditorLayout initialTemplates={templates} />\n    );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEe,eAAe;IAC1B,MAAM,YAAY,MAAM,CAAA,GAAA,kHAAA,CAAA,oBAAiB,AAAD;IAExC,qBACI,8OAAC,+JAAA,CAAA,uBAAoB;QAAC,kBAAkB;;;;;;AAEhD","debugId":null}}]
}