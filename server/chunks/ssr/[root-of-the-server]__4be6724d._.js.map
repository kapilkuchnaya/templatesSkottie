{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers'\nimport { SignJWT, jwtVerify } from 'jose'\n\nconst secretKey = process.env.SESSION_SECRET;\nconst key = new TextEncoder().encode(secretKey);\n\nexport async function encrypt(payload: any) {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('1d')\n    .sign(key)\n}\n\nexport async function decrypt(input: string): Promise<any> {\n  try {\n    const { payload } = await jwtVerify(input, key, {\n      algorithms: ['HS256'],\n    })\n    return payload\n  } catch (error) {\n    return null\n  }\n}\n\nexport async function createSession(userId: string) {\n  const expires = new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 hours\n  const session = await encrypt({ userId, expires })\n\n  cookies().set('session', session, { expires, httpOnly: true })\n}\n\nexport async function getSession() {\n  const sessionCookie = cookies().get('session')?.value\n  if (!sessionCookie) return null\n\n  const session = await decrypt(sessionCookie);\n  if (!session) return null;\n\n  if (new Date(session.expires) < new Date()) {\n    return null;\n  }\n  \n  return session;\n}\n\nexport async function deleteSession() {\n  cookies().set('session', '', { expires: new Date(0) })\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,cAAc;AAC5C,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,QAAQ,OAAY;IACxC,OAAO,MAAM,IAAI,0JAAA,CAAA,UAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAQ,KAAa;IACzC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,4JAAA,CAAA,YAAS,AAAD,EAAE,OAAO,KAAK;YAC9C,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,cAAc,MAAc;IAChD,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK,MAAM,WAAW;;IACtE,MAAM,UAAU,MAAM,QAAQ;QAAE;QAAQ;IAAQ;IAEhD,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,WAAW,SAAS;QAAE;QAAS,UAAU;IAAK;AAC9D;AAEO,eAAe;IACpB,MAAM,gBAAgB,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,YAAY;IAChD,IAAI,CAAC,eAAe,OAAO;IAE3B,MAAM,UAAU,MAAM,QAAQ;IAC9B,IAAI,CAAC,SAAS,OAAO;IAErB,IAAI,IAAI,KAAK,QAAQ,OAAO,IAAI,IAAI,QAAQ;QAC1C,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,WAAW,IAAI;QAAE,SAAS,IAAI,KAAK;IAAG;AACtD","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { redirect } from \"next/navigation\";\nimport { createSession, deleteSession } from \"@/lib/auth\";\n\nexport type State = {\n  error?: string;\n  message?: string;\n  success?: boolean;\n};\n\nexport async function authenticate(\n  prevState: State | undefined,\n  formData: FormData\n) {\n  try {\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n    \n    if (email !== process.env.ADMIN_EMAIL) {\n      return { error: \"Invalid email address.\" };\n    }\n\n    if (password !== process.env.ADMIN_PASSWORD) {\n      return { error: \"Invalid password.\" };\n    }\n\n    await createSession(email);\n\n  } catch (error) {\n    if (error instanceof Error && error.message.includes(\"CredentialsSignin\")) {\n      return { error: \"Invalid credentials.\" };\n    }\n    // Don't redirect in the action when an error occurs\n    // Instead, return an error state.\n    return { error: \"Something went wrong.\" };\n  }\n  \n  // On success, redirect from the client-side or use next/navigation.\n  // We will redirect from the component.\n  return { success: true };\n}\n\n\nexport async function logout() {\n  await deleteSession();\n  redirect(\"/\");\n}\n"],"names":[],"mappings":";;;;;;AAEA;AAAA;AACA;;;;;;AAQO,eAAe,aACpB,SAA4B,EAC5B,QAAkB;IAElB,IAAI;QACF,MAAM,QAAQ,SAAS,GAAG,CAAC;QAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;QAE9B,IAAI,UAAU,QAAQ,GAAG,CAAC,WAAW,EAAE;YACrC,OAAO;gBAAE,OAAO;YAAyB;QAC3C;QAEA,IAAI,aAAa,QAAQ,GAAG,CAAC,cAAc,EAAE;YAC3C,OAAO;gBAAE,OAAO;YAAoB;QACtC;QAEA,MAAM,CAAA,GAAA,kHAAA,CAAA,gBAAa,AAAD,EAAE;IAEtB,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,SAAS,MAAM,OAAO,CAAC,QAAQ,CAAC,sBAAsB;YACzE,OAAO;gBAAE,OAAO;YAAuB;QACzC;QACA,oDAAoD;QACpD,kCAAkC;QAClC,OAAO;YAAE,OAAO;QAAwB;IAC1C;IAEA,oEAAoE;IACpE,uCAAuC;IACvC,OAAO;QAAE,SAAS;IAAK;AACzB;AAGO,eAAe;IACpB,MAAM,CAAA,GAAA,kHAAA,CAAA,gBAAa,AAAD;IAClB,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;AACX;;;IApCsB;IAiCA;;AAjCA,+OAAA;AAiCA,+OAAA","debugId":null}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {authenticate as '60922b336b8354a99e49216e2c19945e6c44dbe7c1'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/login-form.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const LoginForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call LoginForm() from the server but LoginForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/login-form.tsx <module evaluation>\",\n    \"LoginForm\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,+DACA","debugId":null}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/login-form.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const LoginForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call LoginForm() from the server but LoginForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/login-form.tsx\",\n    \"LoginForm\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,2CACA","debugId":null}},
    {"offset": {"line": 239, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/icons.tsx"],"sourcesContent":["import type { SVGProps } from \"react\";\n\nexport function IconSkottie(props: SVGProps<SVGSVGElement>) {\n    return (\n        <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            {...props}\n        >\n            <path d=\"M12 2l-8 4 8 4 8-4-8-4z\" />\n            <path d=\"M4 10l8 4 8-4\" />\n            <path d=\"M4 18l8-4 8 4\" />\n            <path d=\"M4 14l8 4 8-4\" />\n        </svg>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEO,SAAS,YAAY,KAA8B;IACtD,qBACI,8OAAC;QACG,OAAM;QACN,SAAQ;QACR,MAAK;QACL,QAAO;QACP,aAAY;QACZ,eAAc;QACd,gBAAe;QACd,GAAG,KAAK;;0BAET,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;0BACR,8OAAC;gBAAK,GAAE;;;;;;;;;;;;AAGpB","debugId":null}},
    {"offset": {"line": 306, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx"],"sourcesContent":["import { LoginForm } from \"@/components/login-form\";\nimport { IconSkottie } from \"@/components/icons\";\n\nexport default function LoginPage() {\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-center bg-background p-4\">\n      <div className=\"w-full max-w-sm\">\n        <div className=\"mb-8 flex flex-col items-center\">\n          <IconSkottie className=\"h-16 w-16 text-primary\" />\n          <h1 className=\"mt-4 text-3xl font-headline font-bold text-center\">\n            Skottie Viewer\n          </h1>\n          <p className=\"text-muted-foreground text-center\">\n            Admin Login\n          </p>\n        </div>\n        <LoginForm />\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEe,SAAS;IACtB,qBACE,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,2HAAA,CAAA,cAAW;4BAAC,WAAU;;;;;;sCACvB,8OAAC;4BAAG,WAAU;sCAAoD;;;;;;sCAGlE,8OAAC;4BAAE,WAAU;sCAAoC;;;;;;;;;;;;8BAInD,8OAAC,mIAAA,CAAA,YAAS;;;;;;;;;;;;;;;;AAIlB","debugId":null}}]
}